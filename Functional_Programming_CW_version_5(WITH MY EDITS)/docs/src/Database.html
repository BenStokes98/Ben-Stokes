<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-|
Module      : Database
Copyright   : (c) Ben Stokes, 2022
                  Navid Sheikh, 2022
-}</span><span>
</span><span id="line-6"></span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- or, on GHCI:</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- &gt; :set -XOverloadedStrings</span><span>
</span><span id="line-10"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Database</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-11"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Database Structure Setup</span></span><span>
</span><span id="line-12"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-13"></span><span>    </span><span class="hs-comment">-- | Used to set up the entries, summary</span><span>
</span><span id="line-14"></span><span>    </span><span class="hs-comment">-- and program tables in SQLite.</span><span>
</span><span id="line-15"></span><span>    </span><span class="annot"><a href="Database.html#initialiseDB"><span class="hs-identifier">initialiseDB</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-16"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Database Insert </span></span><span>
</span><span id="line-17"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-18"></span><span>    </span><span class="hs-comment">-- | For insert of records into the newly created entries, summary</span><span>
</span><span id="line-19"></span><span>    </span><span class="hs-comment">-- and program tables. </span><span>
</span><span id="line-20"></span><span>    </span><span class="annot"><a href="Database.html#getOrCreateProgram"><span class="hs-identifier">getOrCreateProgram</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-21"></span><span>    </span><span class="annot"><a href="Database.html#createRecord"><span class="hs-identifier">createRecord</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-22"></span><span>    </span><span class="annot"><a href="Database.html#saveRecordsEntries"><span class="hs-identifier">saveRecordsEntries</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>    </span><span class="annot"><a href="Database.html#saveRecordsSummary"><span class="hs-identifier">saveRecordsSummary</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>    </span><span class="annot"><a href="Database.html#createSummary"><span class="hs-identifier">createSummary</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-25"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Error handling  </span></span><span>
</span><span id="line-26"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-27"></span><span>    </span><span class="hs-comment">-- | Allows Maybe Int to be parsed and then can check to see if the input</span><span>
</span><span id="line-28"></span><span>    </span><span class="hs-comment">-- is of type Int. If not, an error will be thrown.</span><span>
</span><span id="line-29"></span><span>    </span><span class="annot"><a href="Database.html#maybeRead"><span class="hs-identifier">maybeRead</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-30"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Random Int Generator </span></span><span>
</span><span id="line-31"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-32"></span><span>    </span><span class="annot"><span class="hs-comment">-- | Used during the 'queryProgramRandomSummary' function to get the random value.</span></span><span>
</span><span id="line-33"></span><span>    </span><span class="annot"><a href="Database.html#getRandomInt"><span class="hs-identifier">getRandomInt</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-34"></span><span>    </span><span class="annot"><a href="Database.html#countRecords"><span class="hs-identifier">countRecords</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-35"></span><span>    </span><span class="annot"><a href="Database.html#countRecordsInt"><span class="hs-identifier">countRecordsInt</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-36"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Query Programs </span></span><span>
</span><span id="line-37"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-38"></span><span>    </span><span class="annot"><span class="hs-comment">-- | Functions created to query the database based on the users desired functionality.</span></span><span>
</span><span id="line-39"></span><span>    </span><span class="annot"><a href="Database.html#queryProgramAllEntries"><span class="hs-identifier">queryProgramAllEntries</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-40"></span><span>    </span><span class="annot"><a href="Database.html#queryProgramSummary"><span class="hs-identifier">queryProgramSummary</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-41"></span><span>    </span><span class="annot"><a href="Database.html#queryAllProgramEnded"><span class="hs-identifier">queryAllProgramEnded</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-42"></span><span>    </span><span class="annot"><a href="Database.html#queryProgramPremieredDate"><span class="hs-identifier">queryProgramPremieredDate</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-43"></span><span>    </span><span class="annot"><a href="Database.html#query5RandomPrograms"><span class="hs-identifier">query5RandomPrograms</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-44"></span><span>    </span><span class="annot"><a href="Database.html#queryProgramRandomSummary"><span class="hs-identifier">queryProgramRandomSummary</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-45"></span><span>    </span><span class="annot"><a href="Database.html#countAllRunningProgram"><span class="hs-identifier">countAllRunningProgram</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-46"></span><span>    </span><span class="annot"><a href="Database.html#queryRunningProgram"><span class="hs-identifier">queryRunningProgram</span></a></span><span>
</span><span id="line-47"></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Types.html"><span class="hs-identifier">Types</span></a></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Database.SQLite.Simple</span></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Random</span></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">listToMaybe</span></span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span class="hs-comment">-- | Method to create database shows.db using Database.SQLite.Simple.</span><span>
</span><span id="line-56"></span><span class="annot"><a href="Database.html#initialiseDB"><span class="hs-identifier hs-type">initialiseDB</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Connection</span></span><span>
</span><span id="line-57"></span><span id="initialiseDB"><span class="annot"><span class="annottext">initialiseDB :: IO Connection
</span><a href="Database.html#initialiseDB"><span class="hs-identifier hs-var hs-var">initialiseDB</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-58"></span><span>        </span><span id="local-6989586621679111790"><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621679111790"><span class="hs-identifier hs-var">conn</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; IO Connection
</span><span class="hs-identifier hs-var">open</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;shows.db&quot;</span></span><span>
</span><span id="line-59"></span><span>        </span><span class="annot"><span class="annottext">Connection -&gt; Query -&gt; IO ()
</span><span class="hs-identifier hs-var">execute_</span></span><span> </span><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621679111790"><span class="hs-identifier hs-var">conn</span></a></span><span> </span><span class="annot"><span class="annottext">Query
</span><span class="hs-string">&quot;CREATE TABLE IF NOT EXISTS program (\
        \id INTEGER PRIMARY KEY AUTOINCREMENT,\
        \program VARCHAR(200) NOT NULL\
        \)&quot;</span></span><span>
</span><span id="line-63"></span><span>        </span><span class="annot"><span class="annottext">Connection -&gt; Query -&gt; IO ()
</span><span class="hs-identifier hs-var">execute_</span></span><span> </span><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621679111790"><span class="hs-identifier hs-var">conn</span></a></span><span> </span><span class="annot"><span class="annottext">Query
</span><span class="hs-string">&quot;CREATE TABLE IF NOT EXISTS entries (\
        \weight INT,\
        \runtime INT,\
        \premiered DATE, \
        \ended DATE DEFAULT NULL,\
        \language INT DEFAULT NULL, \
        \site VARCHAR(300),\
        \status VARCHAR(80) DEFAULT NULL,\
        \fk_program INTEGER\
        \)&quot;</span></span><span>
</span><span id="line-73"></span><span>        </span><span class="annot"><span class="annottext">Connection -&gt; Query -&gt; IO ()
</span><span class="hs-identifier hs-var">execute_</span></span><span> </span><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621679111790"><span class="hs-identifier hs-var">conn</span></a></span><span> </span><span class="annot"><span class="annottext">Query
</span><span class="hs-string">&quot;CREATE TABLE IF NOT EXISTS summary (\
        \summary VARCHAR(2000) NOT NULL,\
        \fk_program INTEGER\
        \)&quot;</span></span><span>
</span><span id="line-77"></span><span>        </span><span class="annot"><span class="annottext">Connection -&gt; IO Connection
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621679111790"><span class="hs-identifier hs-var">conn</span></a></span><span>
</span><span id="line-78"></span><span>
</span><span id="line-79"></span><span>
</span><span id="line-80"></span><span class="hs-comment">-- | Insert records into program table. </span><span>
</span><span id="line-81"></span><span class="hs-comment">--</span><span>
</span><span id="line-82"></span><span class="hs-comment">-- Able to prevent dulpication of records in the table.</span><span>
</span><span id="line-83"></span><span class="annot"><a href="Database.html#getOrCreateProgram"><span class="hs-identifier hs-type">getOrCreateProgram</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Connection</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="Types.html#Program"><span class="hs-identifier hs-type">Program</span></a></span><span>
</span><span id="line-84"></span><span id="getOrCreateProgram"><span class="annot"><span class="annottext">getOrCreateProgram :: Connection -&gt; [Char] -&gt; IO Program
</span><a href="Database.html#getOrCreateProgram"><span class="hs-identifier hs-var hs-var">getOrCreateProgram</span></a></span></span><span> </span><span id="local-6989586621679111787"><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621679111787"><span class="hs-identifier hs-var">conn</span></a></span></span><span> </span><span id="local-6989586621679111786"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679111786"><span class="hs-identifier hs-var">prog</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-85"></span><span>    </span><span id="local-6989586621679111785"><span class="annot"><span class="annottext">[Program]
</span><a href="#local-6989586621679111785"><span class="hs-identifier hs-var">results</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Connection -&gt; Query -&gt; [NamedParam] -&gt; IO [Program]
forall r.
FromRow r =&gt;
Connection -&gt; Query -&gt; [NamedParam] -&gt; IO [r]
</span><span class="hs-identifier hs-var">queryNamed</span></span><span> </span><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621679111787"><span class="hs-identifier hs-var">conn</span></a></span><span> </span><span class="annot"><span class="annottext">Query
</span><span class="hs-string">&quot;SELECT * FROM program WHERE program=:program&quot;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;:program&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; [Char] -&gt; NamedParam
forall v. ToField v =&gt; Text -&gt; v -&gt; NamedParam
</span><span class="hs-operator hs-var">:=</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679111786"><span class="hs-identifier hs-var">prog</span></a></span><span class="hs-special">]</span><span>    </span><span>
</span><span id="line-86"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[Program] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Program]
</span><a href="#local-6989586621679111785"><span class="hs-identifier hs-var">results</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">then</span><span>
</span><span id="line-87"></span><span>        </span><span class="annot"><span class="annottext">Program -&gt; IO Program
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Program -&gt; IO Program)
-&gt; ([Program] -&gt; Program) -&gt; [Program] -&gt; IO Program
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Program] -&gt; Program
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">([Program] -&gt; IO Program) -&gt; [Program] -&gt; IO Program
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Program]
</span><a href="#local-6989586621679111785"><span class="hs-identifier hs-var">results</span></a></span><span>
</span><span id="line-88"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-89"></span><span>        </span><span class="annot"><span class="annottext">Connection -&gt; Query -&gt; [[Char]] -&gt; IO ()
forall q. ToRow q =&gt; Connection -&gt; Query -&gt; q -&gt; IO ()
</span><span class="hs-identifier hs-var">execute</span></span><span> </span><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621679111787"><span class="hs-identifier hs-var">conn</span></a></span><span> </span><span class="annot"><span class="annottext">Query
</span><span class="hs-string">&quot;INSERT INTO program (program) VALUES (?)&quot;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679111786"><span class="hs-identifier hs-var">prog</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span>
</span><span id="line-90"></span><span>        </span><span class="annot"><span class="annottext">Connection -&gt; [Char] -&gt; IO Program
</span><a href="Database.html#getOrCreateProgram"><span class="hs-identifier hs-var">getOrCreateProgram</span></a></span><span> </span><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621679111787"><span class="hs-identifier hs-var">conn</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679111786"><span class="hs-identifier hs-var">prog</span></a></span><span>
</span><span id="line-91"></span><span>
</span><span id="line-92"></span><span>
</span><span id="line-93"></span><span class="hs-comment">-- | Creates a record with type 'Entry' from the 'Record' values and inserts into the entries table.</span><span>
</span><span id="line-94"></span><span class="annot"><a href="Database.html#createRecord"><span class="hs-identifier hs-type">createRecord</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Connection</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Types.html#Record"><span class="hs-identifier hs-type">Record</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-95"></span><span id="createRecord"><span class="annot"><span class="annottext">createRecord :: Connection -&gt; Record -&gt; IO ()
</span><a href="Database.html#createRecord"><span class="hs-identifier hs-var hs-var">createRecord</span></a></span></span><span> </span><span id="local-6989586621679111777"><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621679111777"><span class="hs-identifier hs-var">conn</span></a></span></span><span> </span><span id="local-6989586621679111776"><span class="annot"><span class="annottext">Record
</span><a href="#local-6989586621679111776"><span class="hs-identifier hs-var">record</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-96"></span><span>    </span><span id="local-6989586621679111775"><span class="annot"><span class="annottext">Program
</span><a href="#local-6989586621679111775"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Connection -&gt; [Char] -&gt; IO Program
</span><a href="Database.html#getOrCreateProgram"><span class="hs-identifier hs-var">getOrCreateProgram</span></a></span><span> </span><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621679111777"><span class="hs-identifier hs-var">conn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Record -&gt; [Char]
</span><a href="Types.html#program"><span class="hs-identifier hs-var hs-var">program</span></a></span><span> </span><span class="annot"><span class="annottext">Record
</span><a href="#local-6989586621679111776"><span class="hs-identifier hs-var">record</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-97"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679111773"><span class="annot"><span class="annottext">entry :: Entry
</span><a href="#local-6989586621679111773"><span class="hs-identifier hs-var hs-var">entry</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Entry :: Maybe Int
-&gt; Maybe Int
-&gt; Maybe [Char]
-&gt; Maybe [Char]
-&gt; Maybe [Char]
-&gt; Maybe [Char]
-&gt; Maybe [Char]
-&gt; Maybe Int
-&gt; Entry
</span><a href="Types.html#Entry"><span class="hs-identifier hs-type">Entry</span></a></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-98"></span><span>        </span><span class="annot"><span class="annottext">weight_ :: Maybe Int
</span><a href="Types.html#weight_"><span class="hs-identifier hs-var">weight_</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Record -&gt; Maybe Int
</span><a href="Types.html#weight"><span class="hs-identifier hs-var hs-var">weight</span></a></span><span> </span><span class="annot"><span class="annottext">Record
</span><a href="#local-6989586621679111776"><span class="hs-identifier hs-var">record</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span>
</span><span id="line-99"></span><span>        </span><span class="annot"><span class="annottext">runtime_ :: Maybe Int
</span><a href="Types.html#runtime_"><span class="hs-identifier hs-var">runtime_</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Record -&gt; Maybe Int
</span><a href="Types.html#runtime"><span class="hs-identifier hs-var hs-var">runtime</span></a></span><span> </span><span class="annot"><span class="annottext">Record
</span><a href="#local-6989586621679111776"><span class="hs-identifier hs-var">record</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span>
</span><span id="line-100"></span><span>        </span><span class="annot"><span class="annottext">premiered_ :: Maybe [Char]
</span><a href="Types.html#premiered_"><span class="hs-identifier hs-var">premiered_</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Record -&gt; Maybe [Char]
</span><a href="Types.html#premiered"><span class="hs-identifier hs-var hs-var">premiered</span></a></span><span> </span><span class="annot"><span class="annottext">Record
</span><a href="#local-6989586621679111776"><span class="hs-identifier hs-var">record</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span>
</span><span id="line-101"></span><span>        </span><span class="annot"><span class="annottext">ended_ :: Maybe [Char]
</span><a href="Types.html#ended_"><span class="hs-identifier hs-var">ended_</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Record -&gt; Maybe [Char]
</span><a href="Types.html#ended"><span class="hs-identifier hs-var hs-var">ended</span></a></span><span> </span><span class="annot"><span class="annottext">Record
</span><a href="#local-6989586621679111776"><span class="hs-identifier hs-var">record</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span>
</span><span id="line-102"></span><span>        </span><span class="annot"><span class="annottext">language_ :: Maybe [Char]
</span><a href="Types.html#language_"><span class="hs-identifier hs-var">language_</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Record -&gt; Maybe [Char]
</span><a href="Types.html#language"><span class="hs-identifier hs-var hs-var">language</span></a></span><span> </span><span class="annot"><span class="annottext">Record
</span><a href="#local-6989586621679111776"><span class="hs-identifier hs-var">record</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span>
</span><span id="line-103"></span><span>        </span><span class="annot"><span class="annottext">site_ :: Maybe [Char]
</span><a href="Types.html#site_"><span class="hs-identifier hs-var">site_</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Record -&gt; Maybe [Char]
</span><a href="Types.html#site"><span class="hs-identifier hs-var hs-var">site</span></a></span><span> </span><span class="annot"><span class="annottext">Record
</span><a href="#local-6989586621679111776"><span class="hs-identifier hs-var">record</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span>
</span><span id="line-104"></span><span>        </span><span class="annot"><span class="annottext">status_ :: Maybe [Char]
</span><a href="Types.html#status_"><span class="hs-identifier hs-var">status_</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Record -&gt; Maybe [Char]
</span><a href="Types.html#status"><span class="hs-identifier hs-var hs-var">status</span></a></span><span> </span><span class="annot"><span class="annottext">Record
</span><a href="#local-6989586621679111776"><span class="hs-identifier hs-var">record</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span>
</span><span id="line-105"></span><span>        </span><span class="annot"><span class="annottext">fk_program1 :: Maybe Int
</span><a href="Types.html#fk_program1"><span class="hs-identifier hs-var">fk_program1</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Program -&gt; Maybe Int
</span><a href="Types.html#id_"><span class="hs-identifier hs-var hs-var">id_</span></a></span><span> </span><span class="annot"><span class="annottext">Program
</span><a href="#local-6989586621679111775"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-106"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-107"></span><span>    </span><span class="annot"><span class="annottext">Connection -&gt; Query -&gt; Entry -&gt; IO ()
forall q. ToRow q =&gt; Connection -&gt; Query -&gt; q -&gt; IO ()
</span><span class="hs-identifier hs-var">execute</span></span><span> </span><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621679111777"><span class="hs-identifier hs-var">conn</span></a></span><span> </span><span class="annot"><span class="annottext">Query
</span><span class="hs-string">&quot;INSERT INTO entries VALUES (?,?,?,?,?,?,?,?)&quot;</span></span><span> </span><span class="annot"><span class="annottext">Entry
</span><a href="#local-6989586621679111773"><span class="hs-identifier hs-var">entry</span></a></span><span>
</span><span id="line-108"></span><span>
</span><span id="line-109"></span><span class="hs-comment">-- | Creates a record with type 'Summary' from the 'Record' values and inserts into the entries table.</span><span>
</span><span id="line-110"></span><span class="annot"><a href="Database.html#createSummary"><span class="hs-identifier hs-type">createSummary</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Connection</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Types.html#Record"><span class="hs-identifier hs-type">Record</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-111"></span><span id="createSummary"><span class="annot"><span class="annottext">createSummary :: Connection -&gt; Record -&gt; IO ()
</span><a href="Database.html#createSummary"><span class="hs-identifier hs-var hs-var">createSummary</span></a></span></span><span> </span><span id="local-6989586621679111755"><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621679111755"><span class="hs-identifier hs-var">conn</span></a></span></span><span> </span><span id="local-6989586621679111754"><span class="annot"><span class="annottext">Record
</span><a href="#local-6989586621679111754"><span class="hs-identifier hs-var">record</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-112"></span><span>    </span><span id="local-6989586621679111753"><span class="annot"><span class="annottext">Program
</span><a href="#local-6989586621679111753"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Connection -&gt; [Char] -&gt; IO Program
</span><a href="Database.html#getOrCreateProgram"><span class="hs-identifier hs-var">getOrCreateProgram</span></a></span><span> </span><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621679111755"><span class="hs-identifier hs-var">conn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Record -&gt; [Char]
</span><a href="Types.html#program"><span class="hs-identifier hs-var hs-var">program</span></a></span><span> </span><span class="annot"><span class="annottext">Record
</span><a href="#local-6989586621679111754"><span class="hs-identifier hs-var">record</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-113"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679111752"><span class="annot"><span class="annottext">insertsummary :: Summary
</span><a href="#local-6989586621679111752"><span class="hs-identifier hs-var hs-var">insertsummary</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Summary :: Maybe [Char] -&gt; Maybe Int -&gt; Summary
</span><a href="Types.html#Summary"><span class="hs-identifier hs-type">Summary</span></a></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-114"></span><span>        </span><span class="annot"><span class="annottext">summary_ :: Maybe [Char]
</span><a href="Types.html#summary_"><span class="hs-identifier hs-var">summary_</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Record -&gt; Maybe [Char]
</span><a href="Types.html#summary"><span class="hs-identifier hs-var hs-var">summary</span></a></span><span> </span><span class="annot"><span class="annottext">Record
</span><a href="#local-6989586621679111754"><span class="hs-identifier hs-var">record</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span>
</span><span id="line-115"></span><span>        </span><span class="annot"><span class="annottext">fk_program2 :: Maybe Int
</span><a href="Types.html#fk_program2"><span class="hs-identifier hs-var">fk_program2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Program -&gt; Maybe Int
</span><a href="Types.html#id_"><span class="hs-identifier hs-var hs-var">id_</span></a></span><span> </span><span class="annot"><span class="annottext">Program
</span><a href="#local-6989586621679111753"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-116"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-117"></span><span>    </span><span class="annot"><span class="annottext">Connection -&gt; Query -&gt; Summary -&gt; IO ()
forall q. ToRow q =&gt; Connection -&gt; Query -&gt; q -&gt; IO ()
</span><span class="hs-identifier hs-var">execute</span></span><span> </span><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621679111755"><span class="hs-identifier hs-var">conn</span></a></span><span> </span><span class="annot"><span class="annottext">Query
</span><span class="hs-string">&quot;INSERT INTO summary VALUES (?,?)&quot;</span></span><span> </span><span class="annot"><span class="annottext">Summary
</span><a href="#local-6989586621679111752"><span class="hs-identifier hs-var">insertsummary</span></a></span><span>
</span><span id="line-118"></span><span>
</span><span id="line-119"></span><span>
</span><span id="line-120"></span><span class="hs-comment">-- | Converts a list of integers into a single (non-list) integer.</span><span>
</span><span id="line-121"></span><span class="annot"><a href="Database.html#listToInt"><span class="hs-identifier hs-type">listToInt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-122"></span><span id="listToInt"><span class="annot"><span class="annottext">listToInt :: [Int] -&gt; Int
</span><a href="Database.html#listToInt"><span class="hs-identifier hs-var hs-var">listToInt</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-123"></span><span class="annot"><a href="Database.html#listToInt"><span class="hs-identifier hs-var">listToInt</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679111746"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679111746"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; Int
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679111746"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-124"></span><span>
</span><span id="line-125"></span><span>
</span><span id="line-126"></span><span>
</span><span id="line-127"></span><span class="hs-comment">-- | Error handling for Integers  </span><span>
</span><span id="line-128"></span><span class="hs-comment">--</span><span>
</span><span id="line-129"></span><span class="hs-comment">-- Uses Import Data.Maybe (listToMaybe) for preset of 'listToMaybe' method.</span><span>
</span><span id="line-130"></span><span id="local-6989586621679111947"><span class="annot"><a href="Database.html#maybeRead"><span class="hs-identifier hs-type">maybeRead</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Read</span></span><span> </span><span class="annot"><a href="#local-6989586621679111947"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679111947"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-131"></span><span id="maybeRead"><span class="annot"><span class="annottext">maybeRead :: forall a. Read a =&gt; [Char] -&gt; Maybe a
</span><a href="Database.html#maybeRead"><span class="hs-identifier hs-var hs-var">maybeRead</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((a, [Char]) -&gt; a) -&gt; Maybe (a, [Char]) -&gt; Maybe a
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">(a, [Char]) -&gt; a
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (a, [Char]) -&gt; Maybe a)
-&gt; ([Char] -&gt; Maybe (a, [Char])) -&gt; [Char] -&gt; Maybe a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[(a, [Char])] -&gt; Maybe (a, [Char])
forall a. [a] -&gt; Maybe a
</span><span class="hs-identifier hs-var">listToMaybe</span></span><span> </span><span class="annot"><span class="annottext">([(a, [Char])] -&gt; Maybe (a, [Char]))
-&gt; ([Char] -&gt; [(a, [Char])]) -&gt; [Char] -&gt; Maybe (a, [Char])
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((a, [Char]) -&gt; Bool) -&gt; [(a, [Char])] -&gt; [(a, [Char])]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; Bool) -&gt; ((a, [Char]) -&gt; [Char]) -&gt; (a, [Char]) -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(a, [Char]) -&gt; [Char]
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(a, [Char])] -&gt; [(a, [Char])])
-&gt; ([Char] -&gt; [(a, [Char])]) -&gt; [Char] -&gt; [(a, [Char])]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [(a, [Char])]
forall a. Read a =&gt; ReadS a
</span><span class="hs-identifier hs-var">reads</span></span><span>
</span><span id="line-132"></span><span>
</span><span id="line-133"></span><span class="hs-comment">-- | Invoke function to create entries records.</span><span>
</span><span id="line-134"></span><span class="hs-comment">--</span><span>
</span><span id="line-135"></span><span class="hs-comment">-- Calls upon the 'createRecord' funtion to complete the process.</span><span>
</span><span id="line-136"></span><span class="annot"><a href="Database.html#saveRecordsEntries"><span class="hs-identifier hs-type">saveRecordsEntries</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Connection</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Types.html#Record"><span class="hs-identifier hs-type">Record</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-137"></span><span id="saveRecordsEntries"><span class="annot"><span class="annottext">saveRecordsEntries :: Connection -&gt; [Record] -&gt; IO ()
</span><a href="Database.html#saveRecordsEntries"><span class="hs-identifier hs-var hs-var">saveRecordsEntries</span></a></span></span><span> </span><span id="local-6989586621679111738"><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621679111738"><span class="hs-identifier hs-var">conn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Record -&gt; IO ()) -&gt; [Record] -&gt; IO ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Connection -&gt; Record -&gt; IO ()
</span><a href="Database.html#createRecord"><span class="hs-identifier hs-var">createRecord</span></a></span><span> </span><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621679111738"><span class="hs-identifier hs-var">conn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-138"></span><span>
</span><span id="line-139"></span><span class="hs-comment">-- | Invoke function to create summary records.</span><span>
</span><span id="line-140"></span><span class="hs-comment">--</span><span>
</span><span id="line-141"></span><span class="hs-comment">-- Calls upon the 'createSummary' funtion to complete the process.</span><span>
</span><span id="line-142"></span><span class="annot"><a href="Database.html#saveRecordsSummary"><span class="hs-identifier hs-type">saveRecordsSummary</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Connection</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Types.html#Record"><span class="hs-identifier hs-type">Record</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-143"></span><span id="saveRecordsSummary"><span class="annot"><span class="annottext">saveRecordsSummary :: Connection -&gt; [Record] -&gt; IO ()
</span><a href="Database.html#saveRecordsSummary"><span class="hs-identifier hs-var hs-var">saveRecordsSummary</span></a></span></span><span> </span><span id="local-6989586621679111736"><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621679111736"><span class="hs-identifier hs-var">conn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Record -&gt; IO ()) -&gt; [Record] -&gt; IO ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Connection -&gt; Record -&gt; IO ()
</span><a href="Database.html#createSummary"><span class="hs-identifier hs-var">createSummary</span></a></span><span> </span><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621679111736"><span class="hs-identifier hs-var">conn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-144"></span><span>
</span><span id="line-145"></span><span class="hs-comment">-- | Display certain number of shows based on user input.</span><span>
</span><span id="line-146"></span><span class="hs-comment">--</span><span>
</span><span id="line-147"></span><span class="hs-comment">-- Includes error handeling which prevents users from entering non interger records, by using the 'maybeRead' method.</span><span>
</span><span id="line-148"></span><span class="hs-comment">--</span><span>
</span><span id="line-149"></span><span class="hs-comment">-- Output is of type 'Program' list.</span><span>
</span><span id="line-150"></span><span class="annot"><a href="Database.html#queryProgramAllEntries"><span class="hs-identifier hs-type">queryProgramAllEntries</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Connection</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Types.html#Program"><span class="hs-identifier hs-type">Program</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-151"></span><span id="queryProgramAllEntries"><span class="annot"><span class="annottext">queryProgramAllEntries :: Connection -&gt; IO [Program]
</span><a href="Database.html#queryProgramAllEntries"><span class="hs-identifier hs-var hs-var">queryProgramAllEntries</span></a></span></span><span> </span><span id="local-6989586621679111735"><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621679111735"><span class="hs-identifier hs-var">conn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-152"></span><span>    </span><span class="annot"><span class="annottext">[Char] -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;-----------------------------------------&quot;</span></span><span>
</span><span id="line-153"></span><span>    </span><span class="annot"><span class="annottext">[Char] -&gt; IO ()
</span><span class="hs-identifier hs-var">putStr</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Enter how many shows you want to display  &gt; &quot;</span></span><span>
</span><span id="line-154"></span><span>    </span><span id="local-6989586621679111732"><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679111732"><span class="hs-identifier hs-var">numberOfPrograms</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; Maybe Int) -&gt; IO [Char] -&gt; IO (Maybe Int)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Maybe Int
forall a. Read a =&gt; [Char] -&gt; Maybe a
</span><a href="Database.html#maybeRead"><span class="hs-identifier hs-var">maybeRead</span></a></span><span> </span><span class="annot"><span class="annottext">IO [Char]
</span><span class="hs-identifier hs-var">getLine</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-155"></span><span>    </span><span class="annot"><span class="annottext">IO () -&gt; (Int -&gt; IO ()) -&gt; Maybe Int -&gt; IO ()
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; \n\
                    \!!ERROR!!  Oops, you didn't enter a Integer! Please try again.  !!ERROR!! \n\ 
                    \&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-158"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; IO ()) -&gt; (Int -&gt; [Char]) -&gt; Int -&gt; IO ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Number of shows returned: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; [Char]) -&gt; (Int -&gt; [Char]) -&gt; Int -&gt; [Char]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span class="hs-special">)</span><span>
</span><span id="line-159"></span><span>          </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679111732"><span class="hs-identifier hs-var">numberOfPrograms</span></a></span><span>
</span><span id="line-160"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679111727"><span class="annot"><span class="annottext">sql :: Query
</span><a href="#local-6989586621679111727"><span class="hs-identifier hs-var hs-var">sql</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Query
</span><span class="hs-string">&quot;SELECT  * FROM program  LIMIT ? &quot;</span></span><span>
</span><span id="line-161"></span><span>    </span><span class="annot"><span class="annottext">Connection -&gt; Query -&gt; [Maybe Int] -&gt; IO [Program]
forall q r.
(ToRow q, FromRow r) =&gt;
Connection -&gt; Query -&gt; q -&gt; IO [r]
</span><span class="hs-identifier hs-var">query</span></span><span> </span><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621679111735"><span class="hs-identifier hs-var">conn</span></a></span><span> </span><span class="annot"><span class="annottext">Query
</span><a href="#local-6989586621679111727"><span class="hs-identifier hs-var">sql</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679111732"><span class="hs-identifier hs-var">numberOfPrograms</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-162"></span><span>
</span><span id="line-163"></span><span class="hs-comment">-- | Display the 4 random options + the solution record  to the game </span><span>
</span><span id="line-164"></span><span class="annot"><a href="Database.html#query5RandomPrograms"><span class="hs-identifier hs-type">query5RandomPrograms</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Connection</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Types.html#Program"><span class="hs-identifier hs-type">Program</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-165"></span><span id="query5RandomPrograms"><span class="annot"><span class="annottext">query5RandomPrograms :: Connection -&gt; Int -&gt; IO [Program]
</span><a href="Database.html#query5RandomPrograms"><span class="hs-identifier hs-var hs-var">query5RandomPrograms</span></a></span></span><span> </span><span id="local-6989586621679111725"><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621679111725"><span class="hs-identifier hs-var">conn</span></a></span></span><span> </span><span id="local-6989586621679111724"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679111724"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-166"></span><span>    </span><span class="annot"><span class="annottext">[Char] -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;-----------------------------------------&quot;</span></span><span>
</span><span id="line-167"></span><span>    </span><span class="annot"><span class="annottext">[Char] -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Pick amongst these programs : &quot;</span></span><span>
</span><span id="line-168"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679111722"><span class="annot"><span class="annottext">sql :: Query
</span><a href="#local-6989586621679111722"><span class="hs-identifier hs-var hs-var">sql</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Query
</span><span class="hs-string">&quot;SELECT  * FROM program WHERE program.id = ? UNION SELECT * FROM (SELECT * FROM program ORDER BY RANDOM() LIMIT 4) ORDER BY id&quot;</span></span><span>
</span><span id="line-169"></span><span>    </span><span class="annot"><span class="annottext">Connection -&gt; Query -&gt; [Int] -&gt; IO [Program]
forall q r.
(ToRow q, FromRow r) =&gt;
Connection -&gt; Query -&gt; q -&gt; IO [r]
</span><span class="hs-identifier hs-var">query</span></span><span> </span><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621679111725"><span class="hs-identifier hs-var">conn</span></a></span><span> </span><span class="annot"><span class="annottext">Query
</span><a href="#local-6989586621679111722"><span class="hs-identifier hs-var">sql</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679111724"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-170"></span><span>
</span><span id="line-171"></span><span class="hs-comment">-- | Display the random summary and its status.</span><span>
</span><span id="line-172"></span><span class="hs-comment">--</span><span>
</span><span id="line-173"></span><span class="hs-comment">-- Output is a list of 'RandomSummary' records. </span><span>
</span><span id="line-174"></span><span class="annot"><a href="Database.html#queryProgramRandomSummary"><span class="hs-identifier hs-type">queryProgramRandomSummary</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Connection</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Types.html#RandomSummary"><span class="hs-identifier hs-type">RandomSummary</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-175"></span><span id="queryProgramRandomSummary"><span class="annot"><span class="annottext">queryProgramRandomSummary :: Connection -&gt; Int -&gt; IO [RandomSummary]
</span><a href="Database.html#queryProgramRandomSummary"><span class="hs-identifier hs-var hs-var">queryProgramRandomSummary</span></a></span></span><span> </span><span id="local-6989586621679111721"><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621679111721"><span class="hs-identifier hs-var">conn</span></a></span></span><span> </span><span id="local-6989586621679111720"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679111720"><span class="hs-identifier hs-var">randomID</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-176"></span><span>    </span><span class="annot"><span class="annottext">[Char] -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;-----------------------------------------&quot;</span></span><span>
</span><span id="line-177"></span><span>    </span><span class="annot"><span class="annottext">[Char] -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Guess ID of this movie's summary : &quot;</span></span><span>
</span><span id="line-178"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679111718"><span class="annot"><span class="annottext">sql :: Query
</span><a href="#local-6989586621679111718"><span class="hs-identifier hs-var hs-var">sql</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Query
</span><span class="hs-string">&quot;SELECT DISTINCT REPLACE(REPLACE(REPLACE(REPLACE(summary, '&lt;p&gt;', ''),'&lt;/p&gt;', ''),'&lt;b&gt;', '') ,'&lt;/b&gt;', '') , entries.status FROM summary, entries where summary.fk_program = ? AND entries.fk_program = ?&quot;</span></span><span>
</span><span id="line-179"></span><span>    </span><span class="annot"><span class="annottext">Connection -&gt; Query -&gt; [Int] -&gt; IO [RandomSummary]
forall q r.
(ToRow q, FromRow r) =&gt;
Connection -&gt; Query -&gt; q -&gt; IO [r]
</span><span class="hs-identifier hs-var">query</span></span><span> </span><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621679111721"><span class="hs-identifier hs-var">conn</span></a></span><span> </span><span class="annot"><span class="annottext">Query
</span><a href="#local-6989586621679111718"><span class="hs-identifier hs-var">sql</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679111720"><span class="hs-identifier hs-var">randomID</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679111720"><span class="hs-identifier hs-var">randomID</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-180"></span><span>
</span><span id="line-181"></span><span class="hs-comment">-- | Show the summary of a particular show.</span><span>
</span><span id="line-182"></span><span class="hs-comment">--</span><span>
</span><span id="line-183"></span><span class="hs-comment">-- Includes error handeling which prevents users from entering non interger records, by using the 'maybeRead' method.</span><span>
</span><span id="line-184"></span><span class="hs-comment">--</span><span>
</span><span id="line-185"></span><span class="hs-comment">-- Output is of type 'Summary' list, to display only the show summary and record ID.</span><span>
</span><span id="line-186"></span><span class="annot"><a href="Database.html#queryProgramSummary"><span class="hs-identifier hs-type">queryProgramSummary</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Connection</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Types.html#Summary"><span class="hs-identifier hs-type">Summary</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-187"></span><span id="queryProgramSummary"><span class="annot"><span class="annottext">queryProgramSummary :: Connection -&gt; IO [Summary]
</span><a href="Database.html#queryProgramSummary"><span class="hs-identifier hs-var hs-var">queryProgramSummary</span></a></span></span><span>  </span><span id="local-6989586621679111717"><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621679111717"><span class="hs-identifier hs-var">conn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-188"></span><span>    </span><span class="annot"><span class="annottext">[Char] -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;-----------------------------------------&quot;</span></span><span>
</span><span id="line-189"></span><span>    </span><span class="annot"><span class="annottext">[Char] -&gt; IO ()
</span><span class="hs-identifier hs-var">putStr</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Enter a program ID to display the summary &gt; &quot;</span></span><span>
</span><span id="line-190"></span><span>    </span><span id="local-6989586621679111716"><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679111716"><span class="hs-identifier hs-var">id_show</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; Maybe Int) -&gt; IO [Char] -&gt; IO (Maybe Int)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Maybe Int
forall a. Read a =&gt; [Char] -&gt; Maybe a
</span><a href="Database.html#maybeRead"><span class="hs-identifier hs-var">maybeRead</span></a></span><span> </span><span class="annot"><span class="annottext">IO [Char]
</span><span class="hs-identifier hs-var">getLine</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-191"></span><span>    </span><span class="annot"><span class="annottext">IO () -&gt; (Int -&gt; IO ()) -&gt; Maybe Int -&gt; IO ()
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; \n\
                    \!!ERROR!!  Oops, you didn't enter a Integer! Please try again.  !!ERROR!! \n\ 
                    \&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-194"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; IO ()) -&gt; (Int -&gt; [Char]) -&gt; Int -&gt; IO ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Getting summary for program ID: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; [Char]) -&gt; (Int -&gt; [Char]) -&gt; Int -&gt; [Char]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span class="hs-special">)</span><span>
</span><span id="line-195"></span><span>          </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679111716"><span class="hs-identifier hs-var">id_show</span></a></span><span>
</span><span id="line-196"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679111714"><span class="annot"><span class="annottext">sql :: Query
</span><a href="#local-6989586621679111714"><span class="hs-identifier hs-var hs-var">sql</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Query
</span><span class="hs-string">&quot;SELECT DISTINCT REPLACE(REPLACE(REPLACE(REPLACE(summary, '&lt;p&gt;', ''),'&lt;/p&gt;', ''),'&lt;b&gt;', '') ,'&lt;/b&gt;', ''), fk_program FROM summary where summary.fk_program = ?&quot;</span></span><span>
</span><span id="line-197"></span><span>    </span><span class="annot"><span class="annottext">Connection -&gt; Query -&gt; [Maybe Int] -&gt; IO [Summary]
forall q r.
(ToRow q, FromRow r) =&gt;
Connection -&gt; Query -&gt; q -&gt; IO [r]
</span><span class="hs-identifier hs-var">query</span></span><span> </span><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621679111717"><span class="hs-identifier hs-var">conn</span></a></span><span> </span><span class="annot"><span class="annottext">Query
</span><a href="#local-6989586621679111714"><span class="hs-identifier hs-var">sql</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679111716"><span class="hs-identifier hs-var">id_show</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-198"></span><span>
</span><span id="line-199"></span><span class="hs-comment">-- | Show all shows that have a status of Ended.</span><span>
</span><span id="line-200"></span><span class="hs-comment">--</span><span>
</span><span id="line-201"></span><span class="hs-comment">-- Displays output of type 'ShowWithDate'.</span><span>
</span><span id="line-202"></span><span class="annot"><a href="Database.html#queryAllProgramEnded"><span class="hs-identifier hs-type">queryAllProgramEnded</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Connection</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Types.html#ShowWithDate"><span class="hs-identifier hs-type">ShowWithDate</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-203"></span><span id="queryAllProgramEnded"><span class="annot"><span class="annottext">queryAllProgramEnded :: Connection -&gt; IO [ShowWithDate]
</span><a href="Database.html#queryAllProgramEnded"><span class="hs-identifier hs-var hs-var">queryAllProgramEnded</span></a></span></span><span> </span><span id="local-6989586621679111713"><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621679111713"><span class="hs-identifier hs-var">conn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-204"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679111711"><span class="annot"><span class="annottext">sql :: Query
</span><a href="#local-6989586621679111711"><span class="hs-identifier hs-var hs-var">sql</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Query
</span><span class="hs-string">&quot;SELECT program.id, program, ended FROM program, entries WHERE entries.fk_program == program.id  AND entries.status='Ended' &quot;</span></span><span>
</span><span id="line-205"></span><span>    </span><span class="annot"><span class="annottext">Connection -&gt; Query -&gt; IO [ShowWithDate]
forall r. FromRow r =&gt; Connection -&gt; Query -&gt; IO [r]
</span><span class="hs-identifier hs-var">query_</span></span><span> </span><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621679111713"><span class="hs-identifier hs-var">conn</span></a></span><span> </span><span class="annot"><span class="annottext">Query
</span><a href="#local-6989586621679111711"><span class="hs-identifier hs-var">sql</span></a></span><span> </span><span>
</span><span id="line-206"></span><span>
</span><span id="line-207"></span><span class="hs-comment">-- | Show all the programs premiered before user defined year.</span><span>
</span><span id="line-208"></span><span class="hs-comment">--</span><span>
</span><span id="line-209"></span><span class="hs-comment">-- Displays output of type 'ShowWithDate'.</span><span>
</span><span id="line-210"></span><span class="annot"><a href="Database.html#queryProgramPremieredDate"><span class="hs-identifier hs-type">queryProgramPremieredDate</span></a></span><span> </span><span class="hs-glyph">::</span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Connection</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span class="hs-special">[</span><span class="annot"><a href="Types.html#ShowWithDate"><span class="hs-identifier hs-type">ShowWithDate</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-211"></span><span id="queryProgramPremieredDate"><span class="annot"><span class="annottext">queryProgramPremieredDate :: Connection -&gt; IO [ShowWithDate]
</span><a href="Database.html#queryProgramPremieredDate"><span class="hs-identifier hs-var hs-var">queryProgramPremieredDate</span></a></span></span><span> </span><span id="local-6989586621679111709"><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621679111709"><span class="hs-identifier hs-var">conn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-212"></span><span>    </span><span class="annot"><span class="annottext">[Char] -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;-----------------------------------------&quot;</span></span><span>
</span><span id="line-213"></span><span>    </span><span class="annot"><span class="annottext">[Char] -&gt; IO ()
</span><span class="hs-identifier hs-var">putStr</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Filter movie by year - Enter premier year  &gt; &quot;</span></span><span>
</span><span id="line-214"></span><span>    </span><span id="local-6989586621679111708"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679111708"><span class="hs-identifier hs-var">premieredYear</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO [Char]
</span><span class="hs-identifier hs-var">getLine</span></span><span>
</span><span id="line-215"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679111706"><span class="annot"><span class="annottext">sql :: Query
</span><a href="#local-6989586621679111706"><span class="hs-identifier hs-var hs-var">sql</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Query
</span><span class="hs-string">&quot;SELECT DISTINCT program.id, program, premiered FROM entries, program WHERE entries.fk_program == program.id AND STRFTIME('%Y', entries.premiered) &lt; ? ORDER BY entries.premiered ASC &quot;</span></span><span>
</span><span id="line-216"></span><span>    </span><span class="annot"><span class="annottext">Connection -&gt; Query -&gt; [[Char]] -&gt; IO [ShowWithDate]
forall q r.
(ToRow q, FromRow r) =&gt;
Connection -&gt; Query -&gt; q -&gt; IO [r]
</span><span class="hs-identifier hs-var">query</span></span><span> </span><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621679111709"><span class="hs-identifier hs-var">conn</span></a></span><span> </span><span class="annot"><span class="annottext">Query
</span><a href="#local-6989586621679111706"><span class="hs-identifier hs-var">sql</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679111708"><span class="hs-identifier hs-var">premieredYear</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;-01-01&quot;</span></span><span> </span><span class="hs-special">]</span><span> </span><span>
</span><span id="line-217"></span><span>
</span><span id="line-218"></span><span class="hs-comment">-- | Background method for 'countAllRunningProgram'.</span><span>
</span><span id="line-219"></span><span class="hs-comment">--</span><span>
</span><span id="line-220"></span><span class="hs-comment">-- Queries all programs that are running and outputs the result with type 'ShowWithDate'.</span><span>
</span><span id="line-221"></span><span class="annot"><a href="Database.html#queryRunningProgram"><span class="hs-identifier hs-type">queryRunningProgram</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Connection</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Types.html#ShowWithDate"><span class="hs-identifier hs-type">ShowWithDate</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-222"></span><span id="queryRunningProgram"><span class="annot"><span class="annottext">queryRunningProgram :: Connection -&gt; IO [ShowWithDate]
</span><a href="Database.html#queryRunningProgram"><span class="hs-identifier hs-var hs-var">queryRunningProgram</span></a></span></span><span> </span><span id="local-6989586621679111705"><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621679111705"><span class="hs-identifier hs-var">conn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-223"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679111703"><span class="annot"><span class="annottext">sql :: Query
</span><a href="#local-6989586621679111703"><span class="hs-identifier hs-var hs-var">sql</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Query
</span><span class="hs-string">&quot;SELECT DISTINCT program.id, program, ended FROM program, entries WHERE entries.fk_program == program.id  AND entries.status='Running' &quot;</span></span><span>
</span><span id="line-224"></span><span>    </span><span class="annot"><span class="annottext">Connection -&gt; Query -&gt; IO [ShowWithDate]
forall r. FromRow r =&gt; Connection -&gt; Query -&gt; IO [r]
</span><span class="hs-identifier hs-var">query_</span></span><span> </span><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621679111705"><span class="hs-identifier hs-var">conn</span></a></span><span> </span><span class="annot"><span class="annottext">Query
</span><a href="#local-6989586621679111703"><span class="hs-identifier hs-var">sql</span></a></span><span>
</span><span id="line-225"></span><span>
</span><span id="line-226"></span><span class="hs-comment">-- | Takes the query generated from 'queryRunningProgram' and counts the numbers of rows produced.</span><span>
</span><span id="line-227"></span><span class="annot"><a href="Database.html#countAllRunningProgram"><span class="hs-identifier hs-type">countAllRunningProgram</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Connection</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-228"></span><span id="countAllRunningProgram"><span class="annot"><span class="annottext">countAllRunningProgram :: Connection -&gt; IO ()
</span><a href="Database.html#countAllRunningProgram"><span class="hs-identifier hs-var hs-var">countAllRunningProgram</span></a></span></span><span> </span><span id="local-6989586621679111702"><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621679111702"><span class="hs-identifier hs-var">conn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-229"></span><span>    </span><span id="local-6989586621679111701"><span class="annot"><span class="annottext">[ShowWithDate]
</span><a href="#local-6989586621679111701"><span class="hs-identifier hs-var">runningPrograms</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Connection -&gt; IO [ShowWithDate]
</span><a href="Database.html#queryRunningProgram"><span class="hs-identifier hs-var">queryRunningProgram</span></a></span><span> </span><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621679111702"><span class="hs-identifier hs-var">conn</span></a></span><span>
</span><span id="line-230"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679111699"><span class="annot"><span class="annottext">total :: Int
</span><a href="#local-6989586621679111699"><span class="hs-identifier hs-var hs-var">total</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ShowWithDate] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[ShowWithDate]
</span><a href="#local-6989586621679111701"><span class="hs-identifier hs-var">runningPrograms</span></a></span><span>
</span><span id="line-231"></span><span>    </span><span class="annot"><span class="annottext">[Char] -&gt; IO ()
forall a. Show a =&gt; a -&gt; IO ()
</span><span class="hs-identifier hs-var">print</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; IO ()) -&gt; [Char] -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;The number of running programs in 2022 is : &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679111699"><span class="hs-identifier hs-var">total</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-232"></span><span>
</span><span id="line-233"></span><span class="annot"><a href="Database.html#countRecords"><span class="hs-identifier hs-type">countRecords</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Connection</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Types.html#Program"><span class="hs-identifier hs-type">Program</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-234"></span><span id="countRecords"><span class="annot"><span class="annottext">countRecords :: Connection -&gt; IO [Program]
</span><a href="Database.html#countRecords"><span class="hs-identifier hs-var hs-var">countRecords</span></a></span></span><span> </span><span id="local-6989586621679111698"><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621679111698"><span class="hs-identifier hs-var">conn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-235"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679111696"><span class="annot"><span class="annottext">sql :: Query
</span><a href="#local-6989586621679111696"><span class="hs-identifier hs-var hs-var">sql</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Query
</span><span class="hs-string">&quot;SELECT DISTINCT * FROM program&quot;</span></span><span>
</span><span id="line-236"></span><span>    </span><span class="annot"><span class="annottext">Connection -&gt; Query -&gt; IO [Program]
forall r. FromRow r =&gt; Connection -&gt; Query -&gt; IO [r]
</span><span class="hs-identifier hs-var">query_</span></span><span> </span><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621679111698"><span class="hs-identifier hs-var">conn</span></a></span><span> </span><span class="annot"><span class="annottext">Query
</span><a href="#local-6989586621679111696"><span class="hs-identifier hs-var">sql</span></a></span><span>
</span><span id="line-237"></span><span>
</span><span id="line-238"></span><span class="hs-comment">-- | Takes the query generated from 'queryRunningProgram' and counts the numbers of rows produced.</span><span>
</span><span id="line-239"></span><span class="annot"><a href="Database.html#countRecordsInt"><span class="hs-identifier hs-type">countRecordsInt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Connection</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-240"></span><span id="countRecordsInt"><span class="annot"><span class="annottext">countRecordsInt :: Connection -&gt; IO Int
</span><a href="Database.html#countRecordsInt"><span class="hs-identifier hs-var hs-var">countRecordsInt</span></a></span></span><span> </span><span id="local-6989586621679111695"><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621679111695"><span class="hs-identifier hs-var">conn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-241"></span><span>    </span><span id="local-6989586621679111694"><span class="annot"><span class="annottext">[Program]
</span><a href="#local-6989586621679111694"><span class="hs-identifier hs-var">count</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Connection -&gt; IO [Program]
</span><a href="Database.html#countRecords"><span class="hs-identifier hs-var">countRecords</span></a></span><span> </span><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621679111695"><span class="hs-identifier hs-var">conn</span></a></span><span>
</span><span id="line-242"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679111692"><span class="annot"><span class="annottext">total :: Int
</span><a href="#local-6989586621679111692"><span class="hs-identifier hs-var hs-var">total</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Program] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Program]
</span><a href="#local-6989586621679111694"><span class="hs-identifier hs-var">count</span></a></span><span>
</span><span id="line-243"></span><span>    </span><span class="annot"><span class="annottext">Int -&gt; IO Int
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679111692"><span class="hs-identifier hs-var">total</span></a></span><span>
</span><span id="line-244"></span><span>
</span><span id="line-245"></span><span>
</span><span id="line-246"></span><span class="hs-comment">-- | Generate random number between 1 and 230 (the number of records in our database).</span><span>
</span><span id="line-247"></span><span class="hs-comment">--</span><span>
</span><span id="line-248"></span><span class="hs-comment">-- Makes use of the 'listToInt' function and System.Random import.</span><span>
</span><span id="line-249"></span><span class="annot"><a href="Database.html#getRandomInt"><span class="hs-identifier hs-type">getRandomInt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Connection</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-250"></span><span id="getRandomInt"><span class="annot"><span class="annottext">getRandomInt :: Connection -&gt; IO Int
</span><a href="Database.html#getRandomInt"><span class="hs-identifier hs-var hs-var">getRandomInt</span></a></span></span><span> </span><span id="local-6989586621679111691"><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621679111691"><span class="hs-identifier hs-var">conn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-251"></span><span>   </span><span id="local-6989586621679111690"><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621679111690"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO StdGen
forall (m :: * -&gt; *). MonadIO m =&gt; m StdGen
</span><span class="hs-identifier hs-var">getStdGen</span></span><span>
</span><span id="line-252"></span><span>   </span><span id="local-6989586621679111688"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679111688"><span class="hs-identifier hs-var">maxNoRecords</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Connection -&gt; IO Int
</span><a href="Database.html#countRecordsInt"><span class="hs-identifier hs-var">countRecordsInt</span></a></span><span> </span><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621679111691"><span class="hs-identifier hs-var">conn</span></a></span><span>
</span><span id="line-253"></span><span>   </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679111682"><span class="annot"><span class="annottext">num :: Int
</span><a href="#local-6989586621679111682"><span class="hs-identifier hs-var hs-var">num</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; Int
</span><a href="Database.html#listToInt"><span class="hs-identifier hs-var">listToInt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; [Int] -&gt; [Int]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int, Int) -&gt; StdGen -&gt; [Int]
forall a g. (Random a, RandomGen g) =&gt; (a, a) -&gt; g -&gt; [a]
</span><span class="hs-identifier hs-var">randomRs</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679111688"><span class="hs-identifier hs-var">maxNoRecords</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621679111690"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-254"></span><span>   </span><span class="annot"><span class="annottext">Int -&gt; IO Int
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679111682"><span class="hs-identifier hs-var">num</span></a></span></pre></body></html>